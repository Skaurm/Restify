<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restify - Home</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico?">

    <!-- External Libraries -->
    <script 
        src="https://code.jquery.com/jquery-3.6.3.min.js" 
        integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" 
        crossorigin="anonymous">
    </script>
    <link 
        rel="stylesheet" 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" 
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" 
        crossorigin="anonymous"
    >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">


    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div id="page-container">
        <header>
            <nav class="navbar navbar-expand-lg bg-body-tertiary" id="navbar">
                <div class="container">
                  <a class="navbar-brand" href="index.html">
                    <img id="navbar-logo" src="images/logo_full.png" alt="Restify Logo">
                  </a>
                  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-main" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                  </button>
                  <div class="collapse navbar-collapse" id="navbar-main">
                    <ul class="navbar-nav">
                      <li class="nav-item">
                        <a class="nav-link" href="my-units.html">My Rental Units</a>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link position-relative" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          <i class="fas fa-bell d-none d-lg-block"></i>
                          <span class="d-block d-lg-none dropdown-toggle">Notifications</span>
                          <span class="notification-badge position-absolute translate-middle badge rounded-pill bg-danger d-none d-lg-block">
                            2
                            <span class="visually-hidden">unread messages</span>
                          </span>
                        </a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="#">Thing 1</a></li>
                          <li><a class="dropdown-item" href="#">Thing 2</a></li>
                        </ul>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          Ryan Reynolds
                        </a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="profile.html">Edit profile</a></li>
                          <li><a class="dropdown-item" href="authentication.html">Log out</a></li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </nav>
              <div class="gradient-main"></div>
        </header>
        <main>
            <div class="container">
              <div id="search-container" class="row">
                <div class="col-md-6 col-sm-12 text-center text-md-end">

                  <div>
                    <label for="search-location">Location</label>
                    <input id="search-location" type="text" name="search-location">
                  </div>


                  <div>
                    <label for="search-guests">Guests</label>
                    <select id="search-guests" name="search-guests">
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10</option>

                    </select>
                    
                    <span class="dropdown d-inline-block" id="amenities-dropdown">
                      <span class="dropdown-toggle button button neg" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Amenities
                      </span>
                      <ul class="dropdown-menu">
                        <li><input id="search-amenities-kitchen" type="checkbox" name="search-amenities-kitchen"><label for="search-amenities-kitchen">Kitchen</label></li>
                        <li><input id="search-amenities-pool" type="checkbox" name="search-amenities-pool"><label for="search-amenities-pool">Pool</label></li>
                        <li><input id="search-amenities-laundry" type="checkbox" name="search-amenities-laundry"><label for="search-amenities-laundry">Laundry</label></li>
                      </ul>
                    </span>
                  </div>

                </div>
                <div class="col-md-6 col-sm-12 text-center text-md-start">

                  <div>
                    <label for="search-start-date">From</label>
                    <input id="search-start-date" type="date" name="search-start-date">

                  </div>
                  <div>
                    
                    <label for="search-end-date">To</label>
                    <input id="search-end-date" type="date" name="search-end-date">

                  </div>
                </div>
                <div class="col-sm-12 text-center">
                  <hr>
                  <div>
                    <label for="search-sort-by">Sort By</label>
                    <select id="search-sort-by" name="search-sort-by">
                      <option value="distance">Distance</option>
                      <option value="rating">Rating</option>
                      <option value="price">Price</option>
                    </select>
                  </div>
                  <div>
                    <button id="search-button" class="button button-primary">Search</button>
                  </div>
                  <hr>
                </div>
              </div>
              <div id="results-container" class="row">
                
              </div>

            </div>
        </main>
        <footer class="border-top">
          <div class="container">
            <ul class="nav justify-content-center pb-3 mb-3 border-bottom">
              <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Home</a></li>
              <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">My Rental Units</a></li>
              <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Add Rental Unit</a></li>
              <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Profile</a></li>
            </ul>
            <p class="justify-content-center text-center text-muted">Â© 2023 Restify</p>
          </div>
        </footer>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script 
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" 
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" 
        crossorigin="anonymous">
    </script>
    <script src="js/common.js"></script>
    <script>
      // Temp JS for simulating actual page functionality
      let listingData = [
        {
          id: 0,
          location: "Kelowna, Canada",
          distance: 64,
          cost: 200,
          rating: "4.7"
        },
        {
          id: 3,
          location: "Vernon, Canada",
          distance: 20,
          cost: 320,
          rating: "4.9"
        },
        {
          id: 2,
          location: "Hope, Canada",
          distance: 105,
          cost: 420,
          rating: "4.5"
        },
        {
          id: 1,
          location: "Chilliwack, Canada",
          distance: 38,
          cost: 370,
          rating: "4.4"
        },
        {
          id: 4,
          location: "Agassiz, Canada",
          distance: 24,
          cost: 230,
          rating: "4.4"
        },
        {
          id: 5,
          location: "Penticton, Canada",
          distance: 67,
          cost: 500,
          rating: "4.7"
        },
        {
          id: 6,
          location: "Abbotsford, Canada",
          distance: 55,
          cost: 430,
          rating: "4.9"
        },
        {
          id: 7,
          location: "Burnaby, Canada",
          distance: 323,
          cost: 670,
          rating: "4.8"
        },
        {
          id: 8,
          location: "Richmond, Canada",
          distance: 91,
          cost: 250,
          rating: "4.0"
        },
        {
          id: 9,
          location: "Nanaimo, Canada",
          distance: 70,
          cost: 380,
          rating: "4.3"
        },
        {
          id: 10,
          location: "Delta, Canada",
          distance: 28,
          cost: 520,
          rating: "4.1"
        },
        {
          id: 11,
          location: "Golden, Canada",
          distance: 88,
          cost: 450,
          rating: "4.6"
        },
        {
          id: 12,
          location: "Whistler, Canada",
          distance: 283,
          cost: 390,
          rating: "4.6"
        },
        {
          id: 13,
          location: "Victoria, Canada",
          distance: 246,
          cost: 410,
          rating: "3.8"
        },
        {
          id: 14,
          location: "Kamloops, Canada",
          distance: 653,
          cost: 330,
          rating: "4.6"
        }
      ]

      listingData.sort(function(a, b) { 
        // Smaller distances first
        return a.distance - b.distance;
      })

      function populateListingResults(data) {
        for (const listing of data){
          $("#results-container").append(`
          <div class="col-sm-12 col-md-6 col-lg-4 col-xl-3">
            <a href="listing-details.html">
              <div class="card listing-item">
                <div style="background-image: url('images/houses-exterior/${listing.id + 1}.jpg')" class="card-img-top"></div>
                <div class="card-body">
                  <h4 class="card-title">${listing.location}</h4>
                  <p class="text-muted"><i class="fa-solid fa-star"></i> ${listing.rating}</p>
                  <p class="card-text">${listing.distance}km away</p>
                  <h5 class="card-title">$${listing.cost} CAD / night</h5>
                </div>
              </div>  
            </a>
          </div>
          `)
        }
      }

      populateListingResults(listingData)


      // Search Functionality
      $("#search-button").on("click", function(){

        let sortedProperties = structuredClone(listingData);
      
        // Remove all entries without the city name in it
        let searchLocation = $("#search-location").val();
        if(searchLocation !== "") {
          for(let i=sortedProperties.length - 1;i >= 0; i--) {
            if(!sortedProperties[i].location.toLowerCase().includes(searchLocation.toLowerCase())) {
              sortedProperties.splice(i, 1);
            }
          }
        }


        // Get value to sort properties by
        let sortHeuristic = $("#search-sort-by").val();

        switch(sortHeuristic) {
          case "distance":
            sortedProperties.sort(function(a, b) { 
              // Smaller distances first
              return a.distance - b.distance;
            })
            break;
          case "rating":
            sortedProperties.sort(function(a, b) { 
              // Higher ratings first
              return b.rating - a.rating;
            })
            break;
          case "price":
            sortedProperties.sort(function(a, b) { 
              // Lower cost first
              return a.cost - b.cost;
            })
            break;
          default:
            alert("Unknown sorting heuristic");
        }

        $("#results-container").empty();
        populateListingResults(sortedProperties);

      })

    </script>

</body>
</html>