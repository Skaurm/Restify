<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restify - Profile</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico?">

    <!-- External Libraries -->
    <script 
        src="https://code.jquery.com/jquery-3.6.3.min.js" 
        integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" 
        crossorigin="anonymous">
    </script>
    <link 
        rel="stylesheet" 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" 
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" 
        crossorigin="anonymous"
    >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/profile.css">
</head>
<body>
    <div id="page-container">
        <header>
            <nav class="navbar navbar-expand-lg bg-body-tertiary" id="navbar">
                <div class="container">
                  <a class="navbar-brand" href="index.html">
                    <img id="navbar-logo" src="images/logo_full.png" alt="Restify Logo">
                  </a>
                  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-main" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                  </button>
                  <div class="collapse navbar-collapse" id="navbar-main">
                    <ul class="navbar-nav">
                      <li class="nav-item">
                        <a class="nav-link" href="my-units.html">My Rental Units</a>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link position-relative" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          <i class="fas fa-bell d-none d-lg-block"></i>
                          <span class="d-block d-lg-none dropdown-toggle">Notifications</span>
                          <span class="notification-badge position-absolute translate-middle badge rounded-pill bg-danger d-none d-lg-block">
                            2
                            <span class="visually-hidden">unread messages</span>
                          </span>
                        </a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="#">Thing 1</a></li>
                          <li><a class="dropdown-item" href="#">Thing 2</a></li>
                        </ul>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          Ryan Reynolds
                        </a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="authentication.html">Log out</a></li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </nav>
              <div class="gradient-main"></div>
        </header>
        <main>
          <!-- Section 1 -->
            <div class="container">
                <div class="edit-container">
                    <h1 class="text-primary">Edit Profile</h1>
                      <hr>
                    <div class="row">
                      <div class="col-md-3">
                        <div class="text-center">
                          <img src="https://pyxis.nymag.com/v1/imgs/a93/592/a9fa13bd8541763a579ae0c6d7b8aedc88-14-ryan-reynolds.rsquare.w330.jpg" class="avatar img-circle img-thumbnail" alt="avatar" id="output">
                        </div>
                        <div class="text-center">
                          <h7>Upload a different profile picture</h7>
                          
                          <input type="file" class="form-control" type="file" onchange="loadFile(event)">
                        </div>
                      </div>
                      
                      <div class="col-lg-9">
                        <h3>Personal Information</h3>
                        
                        <form class="form-horizontal" role="form">
                          <div class="form-group">
                            <label class="col-lg-3 control-label">First name:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="Ryan">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Last name:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="Reynolds">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Phone Number:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="123-456-7890">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Email:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="ryanreynolds69@gmail.com">
                            </div>
                          </div>
                        </form>
                      </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-12 text-center">
                        <div>
                          <button class="button button-primary">Update Information</button>
                        </div>
                      </div>
                  </div>
                </div>
                <div class="hide-if-state-1">
                  <h1 class="text-primary">My Reservations</h1>
                    <hr>
                  <div id="results-container" class="row">
                  </div>
                  </div>
                <div class="hide-if-state-1 hide-if-state-2">
                  <h1 class="text-primary">My Reservation Requests</h1>
                  <hr>
                  <div id="reservations-container" class="row">

                  </div>
                  <h1 class="text-primary">My Cancellation Requests</h1>
                  <hr>
                  <div id="cancellations-container" class="row">

                  </div>
                </div>
                <div>
                  <hr>
                  <h3><i class="fa-solid fa-star"></i> 4.91 <span class="text-inline-divider">•</span> 3 Comments</h3>

                  <div class="row" id="comments-container">

                    <!-- Add comments here -->
                    
                  </div>
                </div>
                <!-- Comment Modal -->
                <div id="comment-modal" class="modal" tabindex="-1">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Reply to comment</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <textarea name="comment-modal-body" id="comment-modal-body" cols="30" rows="20" class="d-block w-100" style="height: 70vh; max-height: 200px"></textarea>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="button neg" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="button button-primary">Save changes</button>
                      </div>
                    </div>
                  </div>
                </div>
            </div>>
        </main>
        <footer class="border-top">
            <div class="container">
              <ul class="nav justify-content-center pb-3 mb-3 border-bottom">
                <li class="nav-item"><a href="index.html" class="nav-link px-2 text-muted">Home</a></li>
                <li class="nav-item"><a href="my-units.html" class="nav-link px-2 text-muted">My Rental Units</a></li>
                <li class="nav-item"><a href="add-listing.html" class="nav-link px-2 text-muted">Add Rental Unit</a></li>
                <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Profile</a></li>
              </ul>
              <p class="justify-content-center text-center text-muted">© 2023 Restify</p>
            </div>
          </footer>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script 
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" 
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" 
        crossorigin="anonymous">
    </script>
    <script src="js/common.js"></script>
    <script>
        var loadFile = function (event) {
            var image = document.getElementById("output");
            image.src = URL.createObjectURL(event.target.files[0]);
        };

        let listingData = [
        {
          id: 0,
          location: "Kelowna, Canada",
          distance: 64,
          cost: 200,
          rating: 4.7,
          status: 'pending'
        },
        {
          id: 1,
          location: "Vernon, Canada",
          distance: 20,
          cost: 320,
          rating: 4.9,
          status: 'present'
        }]

        for (const listing of listingData){
          if(listing.status=='pending'){
            $("#results-container").append(`
          <div class="col-sm-12 col-md-6 col-lg-3">
            <a href="#">
              <div class="card listing-item">
                <div style="background-image: url('images/houses-exterior/${listing.id + 1}.jpg')" class="card-img-top"></div>
                <div class="card-body">
                  <h4 class="card-title">${listing.location}</h4>
                  <p class="text-muted"><i class="fa-solid fa-star"></i>${listing.rating}</p>
                  <p class="card-text">${listing.distance}km away</p>
                  <h5 class="card-title">$${listing.cost} CAD / night</h5>
                  <button class="button button-ternary">Pending</button>
                </div>
              </div>  
            </a>
          </div>
          `)
          }
          else{
          $("#results-container").append(`
            <div class="col-sm-12 col-md-6 col-lg-3">
              <a href="#">
                <div class="card listing-item">
                  <div style="background-image: url('images/houses-exterior/${listing.id + 1}.jpg')" class="card-img-top"></div>
                  <div class="card-body">
                    <h4 class="card-title">${listing.location}</h4>
                    <p class="text-muted"><i class="fa-solid fa-star"></i>${listing.rating}</p>
                    <p class="card-text">${listing.distance}km away</p>
                    <h5 class="card-title">$${listing.cost} CAD / night</h5>
                    <button class="button button-ternary">Cancel</button>
                  </div>
                </div>  
              </a>
            </div>
            `)
          }
        }

        let reservationData = [
        {
          id: 0,
          location: "Kelowna, Canada",
          cost: 200,
          dates: "2023/02/06 - 2023/02/08",
          status: 'pending'
        },
        {
          id: 1,
          location: "Vernon, Canada",
          cost: 320,
          dates: "2023/02/09 - 2023/02/05",
          status: 'present'
        }]

        for (const listing of reservationData){
          $("#reservations-container").append(`
          <div class="col-sm-12 col-md-6 col-lg-3">
            <a href="#">
              <div class="card listing-item">
                <div style="background-image: url('images/houses-exterior/${listing.id + 1}.jpg')" class="card-img-top"></div>
                <div class="card-body">
                  <h4 class="card-title">${listing.location}</h4>
                  <p class="card-text">${listing.dates}</p>
                  <h5 class="card-title">$${listing.cost} CAD / night</h5>
                  <span><button class="button button-primary">Approve</button>
                  <button class="button button-ternary">Deny</button><\span>
                </div>
              </div>  
            </a>
          </div>
          `)
      }      

      for (const listing of reservationData){
          $("#cancellations-container").append(`
          <div class="col-sm-12 col-md-6 col-lg-3">
            <a href="#">
              <div class="card listing-item">
                <div style="background-image: url('images/houses-exterior/${listing.id + 1}.jpg')" class="card-img-top"></div>
                <div class="card-body">
                  <h4 class="card-title">${listing.location}</h4>
                  <p class="card-text">${listing.dates}</p>
                  <h5 class="card-title">$${listing.cost} CAD / night</h5>
                  <span><button class="button button-primary">Approve</button>
                  <button class="button button-ternary">Deny</button><\span>
                </div>
              </div>  
            </a>
          </div>
          `)
      }
      
      let comments = [
        {
          id: 1,
          name: "Steph Jobless",
          date: "January 2023",
          property: "Kelowna, Canada", 
          comment: "The property was absolutely stunning. The view was gorgeous and the sunset was breathtaking. The home was cozy and modern and very clean. Lots of walking trails nearby. Looking forward to revisiting in the summer months."
        }, 
        {
          id: 2,
          name: "Will Doors",
          date: "November 2022",
          property: "Vernon, Canada", 
          comment: "The view was spectacular. Love the house and the location. Excellent place to stay."
        },
        {
          id: 3,
          name: "Fej Zebos",
          date: "September 2022",
          property: "Kelowna, Canada", 
          comment: "We had a fantastic time! Would definitely return when the weather warms up to enjoy the water. Beds were very comfy and quiet location which was a nice change."
        },
        {
          id: 4,
          name: "Elongated Muskrat",
          date: "August 2022",
          property: "Vernon, Canada", 
          comment: "Amazing views, amazing location, amazing all round and beautifully appointed. Would definitely recommend this place to anyone. Will definitely be back."
        }
      ]
      let hostComments = [
        {
          replyToId: 1,
          date: "January 2023",
          comment: "Thanks for the review Steph! Unfortunately the house will not be available during the summer due to renovations, but feel free to browse other available times."
        },
      ]
      for(const comment of comments) {
        $("#comments-container").append(`
        <div class="col-sm-12 comment" data-comment-id=${comment.id}>
          <div>
            <div class="profile-picture-container profile-picture-small">
              <img class="profile-picture" src="images/techies/${comment.id}.jpg" alt="Reviewer profile picture">
            </div>
            <div>
              <p class="m-0"><strong>${comment.name} - ${comment.property}</strong></p>
              <p>${comment.date}</p>
            </div>
            <div class="col-sm-12">
              <p class="comment-content">${comment.comment}</p>
            </div>  
            <div class="hide-if-state-1 hide-if-state-2 reply-container">
              <button class="button neg" data-bs-toggle="modal" data-bs-target="#comment-modal"><i class="fa-solid fa-reply"></i> Reply</button>  
            </div>
          </div>
        </div>
        `)
      }
      if(hostReplied == 1) {
        for(const comment of hostComments) {
          let idToFind = comment.replyToId;
          $("#comments-container>.comment").each(function(){
              if($(this).attr("data-comment-id") == idToFind) {
                  $(this).after(`
                  <div class="col-sm-12 comment host-reply hide-if-comment-state-0">
                    <div>
                      <div class="profile-picture-container profile-picture-small">
                        <img class="profile-picture" src="https://pyxis.nymag.com/v1/imgs/a93/592/a9fa13bd8541763a579ae0c6d7b8aedc88-14-ryan-reynolds.rsquare.w330.jpg" alt="Host profile picture">
                      </div>
                      <div>
                        <p class="m-0"><strong>Ryan Reynolds</strong></p>
                        <p>${comment.date}</p>
                      </div>
                      <div class="col-sm-12">
                        <p class="comment-content">${comment.comment}</p>
                      </div>  
                      <div class="hide-if-state-1 hide-if-state-3 reply-container">
                        <button class="button neg" data-bs-toggle="modal" data-bs-target="#comment-modal"><i class="fa-solid fa-reply"></i> Reply</button>  
                      </div>
                    </div>
                  </div>
                  
                  
                  `);

                  // Hode the reply button of the comment
                  $(this).find(".reply-container").hide();
              }
          })
        }
      }
    </script>
</body>
</html>