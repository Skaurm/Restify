<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restify - Profile</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico?">

    <!-- External Libraries -->
    <script 
        src="https://code.jquery.com/jquery-3.6.3.min.js" 
        integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" 
        crossorigin="anonymous">
    </script>
    <link 
        rel="stylesheet" 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" 
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" 
        crossorigin="anonymous"
    >
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/profile.css">
</head>
<body>
    <div id="page-container">
        <header>
            <nav class="navbar navbar-expand-lg bg-body-tertiary" id="navbar">
                <div class="container">
                  <a class="navbar-brand" href="index.html">
                    <img id="navbar-logo" src="images/logo_full.png" alt="Restify Logo">
                  </a>
                  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-main" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                  </button>
                  <div class="collapse navbar-collapse" id="navbar-main">
                    <ul class="navbar-nav">
                      <li class="nav-item">
                        <a class="nav-link" href="my-units.html">My Rental Units</a>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link position-relative" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          <i class="fas fa-bell d-none d-lg-block"></i>
                          <span class="d-block d-lg-none dropdown-toggle">Notifications</span>
                          <span class="notification-badge position-absolute translate-middle badge rounded-pill bg-danger d-none d-lg-block">
                            2
                            <span class="visually-hidden">unread messages</span>
                          </span>
                        </a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="#">Thing 1</a></li>
                          <li><a class="dropdown-item" href="#">Thing 2</a></li>
                        </ul>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          Ryan Reynolds
                        </a>
                        <ul class="dropdown-menu">
                          <li><a class="dropdown-item" href="authentication.html">Log out</a></li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </nav>
              <div class="gradient-main"></div>
        </header>
        <main>
          <!-- Section 1 -->
            <div class="container">
                <div class="edit-container">
                    <h1 class="text-primary hide-if-state-1">Edit Profile</h1>
                    <h1 class="text-primary hide-if-state-2 hide-if-state-3">View User Profile</h1>
                    <hr>
                    <div class="row">
                      <div class="col-md-3">
                        <div class="text-center">
                          <img src="images/reynolds.jpg" class="avatar img-circle img-thumbnail" alt="avatar" id="output">
                        </div>
                        <div class="text-center hide-if-state-1">
                          <p>Upload a different profile picture</p>
                          
                          <input type="file" class="form-control" onchange="loadFile(event)">
                        </div>
                      </div>
                      <!-- Editable version -->
                      <div class="col-lg-9 hide-if-state-1">
                        <h3>Personal Information</h3>
                        
                        <form class="form-horizontal">
                          <div class="form-group">
                            <label class="col-lg-3 control-label">First name:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="Ryan">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Last name:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="Reynolds">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Phone Number:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="123-456-7890">
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Email:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="ryanreynolds69@gmail.com">
                            </div>
                          </div>
                        </form>
                      </div>
                      <!-- Read-only version -->
                      <div class="col-lg-9 hide-if-state-2 hide-if-state-3">
                        <h3>Personal Information</h3>
                        
                        <form class="form-horizontal">
                          <div class="form-group">
                            <label class="col-lg-3 control-label">First name:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="Ryan" disabled>
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Last name:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="Reynolds" disabled>
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Phone Number:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="123-456-7890" disabled>
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-lg-3 control-label">Email:</label>
                            <div class="col-lg-9">
                              <input class="form-control" type="text" value="ryanreynolds69@gmail.com" disabled>
                            </div>
                          </div>
                        </form>
                      </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-12 text-center">
                        <div>
                          <button class="button button-primary hide-if-state-1">Update Information</button>
                        </div>
                      </div>
                  </div>
                </div>
                <div class="hide-if-state-1">
                  <h1 class="text-primary">My Reservations for other Properties</h1>
                    <hr>
                  <div id="approved-container" class="row">
                  </div>
                </div>
                <div class="hide-if-state-1 hide-if-state-2">
                  <h1 class="text-primary">Reservations for my Properties</h1>
                  <button class="button button-primary" onclick="window.location.href='add-listing.html'">Add a listing</button>
                  <hr>
                  <div id="my-approved-container" class="row">

                  </div>
                  <h1 class="text-primary">Requests</h1>
                  <hr>
                  <div id="requests-container" class="row">

                  </div>
                  <!-- <h2 class="text-primary">Cancellation Requests</h2>
                  <hr>
                  <div id="cancellations-container" class="row"> -->

                  <!-- </div> -->
                </div>
                <div>
                  <hr>
                  <h3><i class="fa-solid fa-star"></i> 4.91 <span class="text-inline-divider">•</span> 3 Comments</h3>

                  <div class="row" id="comments-container">

                    <!-- Add comments here -->
                    
                  </div>
                </div>
                <!-- Comment Modal -->
                <div id="comment-modal" class="modal" tabindex="-1">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Reply to comment</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <textarea name="comment-modal-body" id="comment-modal-body" cols="30" rows="20" class="d-block w-100" style="height: 70vh; max-height: 200px"></textarea>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="button neg" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="button button-primary">Save changes</button>
                      </div>
                    </div>
                  </div>
                </div>
            </div>
        </main>
        <footer class="border-top">
            <div class="container">
              <ul class="nav justify-content-center pb-3 mb-3 border-bottom">
                <li class="nav-item"><a href="index.html" class="nav-link px-2 text-muted">Home</a></li>
                <li class="nav-item"><a href="my-units.html" class="nav-link px-2 text-muted">My Rental Units</a></li>
                <li class="nav-item"><a href="add-listing.html" class="nav-link px-2 text-muted">Add Rental Unit</a></li>
                <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Profile</a></li>
              </ul>
              <p class="justify-content-center text-center text-muted">© 2023 Restify</p>
            </div>
          </footer>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script 
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" 
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" 
        crossorigin="anonymous">
    </script>
    <script src="js/common.js"></script>
    <script>
        var loadFile = function (event) {
            var image = document.getElementById("output");
            image.src = URL.createObjectURL(event.target.files[0]);
        };

        const htmlBase = `
          <div class="col-sm-12 col-md-6 col-lg-3">
            <div class="card listing-item">
              <div style="background-image: url('images/houses-exterior/@ID@.jpg')" class="card-img-top"></div>
              <div class="card-body">
                <h4 class="card-title"><a href="listing-details.html">@LOCATION@</a></h4>
                <p class="card-text"><strong>@TYPE@</strong></p>
                @USER@
                <p class="card-text">@DATES@</p>
                <h5 class="card-title">$@COST@ CAD / night</h5>
                @BUTTONS@
              </div>
            </div>  
          </div>
        `

        // Data for reservations that I am initiating
        let listingData = [
        {
          id: 0,
          location: "Kelowna, Canada",
          distance: 64,
          cost: 200,
          rating: "4.7",
          dates: "2023/06/12 - 2023/06/14",
          status: "pending",
          userName: "Johann Frolicht"
        },
        {
          id: 3,
          location: "Vernon, Canada",
          distance: 20,
          cost: 320,
          rating: "4.9",
          dates: "2023/02/10 - 2023/02/20",
          status: "present",
          userName: "Elise Kramer"
        },
        {
          id: 7,
          location: "Burnaby, Canada",
          distance: 323,
          cost: 670,
          rating: "4.8",
          dates: "2023/03/25 - 2023/03/29",
          status: "approved",
          userName: "Gregor Kleine"
        }]

        for (const listing of listingData){
          if(listing.status == "present") {
            $("#approved-container").append(htmlBase
              .replace("@ID@", listing.id + 1)
              .replace("@TYPE@", "Ongoing")
              .replace("@LOCATION@", listing.location)
              .replace("@USER@", `<p class='card-text'>Owner: ${listing.userName}</p>`)
              .replace("@DATES@", listing.dates)
              .replace("@COST@", listing.cost)
              .replace("@BUTTONS@", "")
            )
          } else if(listing.status == "pending") {
            $("#approved-container").append(htmlBase
              .replace("@ID@", listing.id + 1)
              .replace("@TYPE@", "Pending")
              .replace("@LOCATION@", listing.location)
              .replace("@USER@", `<p class='card-text'>Owner: ${listing.userName}</p>`)
              .replace("@DATES@", listing.dates)
              .replace("@COST@", listing.cost)
              .replace("@BUTTONS@", ""
              )
            ) 
          }else if(listing.status == "approved") {
            $("#approved-container").append(htmlBase
              .replace("@ID@", listing.id + 1)
              .replace("@TYPE@", "Approved")
              .replace("@LOCATION@", listing.location)
              .replace("@USER@", `<p class='card-text'>Owner: ${listing.userName}</p>`)
              .replace("@DATES@", listing.dates)
              .replace("@COST@", listing.cost)
              .replace("@BUTTONS@", `
              <button class="button button-danger">Request Cancellation</button>
              `
              )
            ) 
          }
      }    

        // Data for reservations for my properties
        let reservationData = [
          {
            id: 2,
            location: "Hope, Canada",
            cost: 200,
            dates: "2023/04/06 - 2023/04/08",
            status: 'present',
            userName: "Edsgar Von Meierdijk"
          },
          {
            id: 1,
            location: "Chilliwack, Canada",
            cost: 320,
            dates: "2023/04/09 - 2023/04/05",
            status: 'approved',
            userName: "Han Mendelsen"
          },
          {
            id: 4,
            location: "Agassiz, Canada",
            cost: 230,
            dates: "2023/06/01 - 2023/06/06",
            status: "pending",
            userName: "Georg Hessberg"
          },
          {
            id: 5,
            location: "Penticton, Canada",
            cost: 500,
            dates: "2023/05/11 - 2023/05/14",
            status: "request-cancel",
            userName: "Ludwig Schmitt"
          }
        ]
        for (const listing of reservationData){
          if(listing.status == "present") {
            $("#my-approved-container").append(htmlBase
            .replace("@ID@", listing.id + 1)
            .replace("@TYPE@", "Ongoing")
            .replace("@LOCATION@", listing.location)
            .replace("@USER@", `<p class='card-text'>User: ${listing.userName}</p>`)
            .replace("@DATES@", listing.dates)
            .replace("@COST@", listing.cost)
            .replace("@BUTTONS@", `
              <button class="button button-danger">Terminate Prematurely</button>
            `)
            )
          }else if(listing.status == "approved") {
            $("#my-approved-container").append(htmlBase
            .replace("@ID@", listing.id + 1)
            .replace("@TYPE@", "Approved")
            .replace("@LOCATION@", listing.location)
            .replace("@USER@", `<p class='card-text'>User: ${listing.userName}</p>`)
            .replace("@DATES@", listing.dates)
            .replace("@COST@", listing.cost)
            .replace("@BUTTONS@", `
              <button class="button button-danger">Cancel Reservation</button>
            `)
            )
          } else if(listing.status == "pending") {
            $("#requests-container").append(htmlBase
            .replace("@ID@", listing.id + 1)
            .replace("@TYPE@", "Reservation request")
            .replace("@LOCATION@", listing.location)
            .replace("@USER@", `<p class='card-text'>User: ${listing.userName}</p>`)
            .replace("@DATES@", listing.dates)
            .replace("@COST@", listing.cost)
            .replace("@BUTTONS@", `
              <button class="button button-primary">Approve Reservation</button>
              <button class="button button-danger">Deny Reservation</button>
            `)
            )
          }else if(listing.status == "request-cancel") {
            $("#requests-container").append(htmlBase
            .replace("@ID@", listing.id + 1)
            .replace("@TYPE@", "Cancellation request")
            .replace("@LOCATION@", listing.location)
            .replace("@USER@", `<p class='card-text'>User: ${listing.userName}</p>`)
            .replace("@DATES@", listing.dates)
            .replace("@COST@", listing.cost)
            .replace("@BUTTONS@", `
              <button class="button button-warning">Approve Cancellation</button>
              <button class="button button-danger">Deny Cancellation</button>
            `)
            )
          }

      }      
      
      let comments = [
        {
          id: 1,
          name: "Steph Jobless",
          date: "January 2023",
          property: "Kelowna, Canada", 
          comment: "Ryan was clean and communication was organized. You're welcome back any time!"
        }, 
        {
          id: 2,
          name: "Will Doors",
          date: "November 2022",
          property: "Vernon, Canada", 
          comment: "Ryan followed all our policies and was a pleasure to work with."
        },
      ]
      for(const comment of comments) {
        $("#comments-container").append(`
        <div class="col-sm-12 comment" data-comment-id=${comment.id}>
          <div>
            <div class="profile-picture-container profile-picture-small">
              <img class="profile-picture" src="images/techies/${comment.id}.jpg" alt="Reviewer profile picture">
            </div>
            <div>
              <p class="m-0"><strong>${comment.name} - ${comment.property}</strong></p>
              <p>${comment.date}</p>
            </div>
            <div class="col-sm-12">
              <p class="comment-content">${comment.comment}</p>
            </div>  
          </div>
        </div>
        `)
      }
    </script>
</body>
</html>